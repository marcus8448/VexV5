include(CMakeDependentOption)
set(CMAKE_BUILD_TYPE MinSizeRel)

# Logging and debug
option(ENABLE_DEBUG_LOGGING "Enable debug logging" ON)
option(ENABLE_TIMERS "Enable timers" ON)
option(ENABLE_FILE_LOGGING "Enable writing logs to the microSD card" ON)

# Controls
option(USE_ARCADE_DRIVE "Use arcade drive by default" OFF)

# Operations
option(DISABLE_AUTONOMOUS "Disable autonomous code" OFF)

# Screen
option(DISABLE_SCREEN "Disable screen code" OFF)

cmake_dependent_option(DISABLE_CONFIG_SCREEN "Disable the configuration screen" OFF "NOT DISABLE_SCREEN" ON)
cmake_dependent_option(LVGL_DARK_THEME "Enable dark theme for LVGL" ON "NOT DISABLE_SCREEN" OFF)
cmake_dependent_option(DISABLE_AUTONOMOUS_SELECTION_SCREEN "Disable the autonomous selection screen" OFF "NOT DISABLE_SCREEN;NOT DISABLE_AUTONOMOUS" ON)
cmake_dependent_option(DISABLE_DRIVETRAIN_DEBUG_SCREEN "Disable the drivetrain debug screen" OFF "NOT DISABLE_SCREEN" ON)

# Compilation
option(ENABLE_LTO "Enable link time optimization" OFF)
option(ROBOT_B "Alternative mode" OFF)

# Configuration application

if (ENABLE_DEBUG_LOGGING)
    add_compile_definitions(DEBUG_LOG)
endif()

if (ENABLE_TIMERS)
    add_compile_definitions(ENABLE_TIMERS)
endif()

if (ENABLE_FILE_LOGGING)
    add_compile_definitions(FILE_LOG)
endif()

if (USE_ARCADE_DRIVE)
    add_compile_definitions(USE_ARCADE_DRIVE)
endif()

if (DISABLE_AUTONOMOUS)
    add_compile_definitions(DISABLE_AUTONOMOUS)
endif()

if (DISABLE_SCREEN)
    add_compile_definitions(DISABLE_SCREEN)
else()
    if (DISABLE_CONFIG_SCREEN)
        add_compile_definitions(DISABLE_CONFIG_SCREEN)
    endif()
    if (DISABLE_CONFIG_SCREEN)
        add_compile_definitions(DISABLE_CONFIG_SCREEN)
    endif()
    if (DISABLE_AUTONOMOUS OR DISABLE_AUTONOMOUS_SELECTION_SCREEN)
        add_compile_definitions(DISABLE_AUTONOMOUS_SELECTION_SCREEN)
    endif()
    if (DISABLE_DRIVETRAIN_DEBUG_SCREEN)
        add_compile_definitions(DISABLE_DRIVETRAIN_DEBUG_SCREEN)
    endif()
endif()

if (LVGL_DARK_THEME)
    add_compile_definitions(CONFIG_LV_THEME_DEFAULT_DARK=1)
endif()
